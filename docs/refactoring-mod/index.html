<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.66">
<script src="/js/hotkey.js"></script><title data-react-helmet="true">Refactoring an Example Mod | IsaacScript</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docusaurus_language" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Refactoring an Example Mod | IsaacScript"><meta data-react-helmet="true" name="description" content="As your mod grows larger and larger, you will want to stay organized. Splitting up your mod into different files is easy with TypeScript by using import and export. There are many ways to structure a big mod, so think about a hierarchy that makes sense for you."><meta data-react-helmet="true" property="og:description" content="As your mod grows larger and larger, you will want to stay organized. Splitting up your mod into different files is easy with TypeScript by using import and export. There are many ways to structure a big mod, so think about a hierarchy that makes sense for you."><meta data-react-helmet="true" property="og:url" content="https://isaacscript.github.io/docs/refactoring-mod"><link data-react-helmet="true" rel="shortcut icon" href="/images/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://isaacscript.github.io/docs/refactoring-mod"><link rel="stylesheet" href="/styles.b1123bec.css">
<link rel="stylesheet" href="/main.103933fb.css">
<link rel="stylesheet" href="/1be78505.0edf629a.css">
<link rel="preload" href="/styles.a1659319.js" as="script">
<link rel="preload" href="/runtime~main.8369a129.js" as="script">
<link rel="preload" href="/main.2a6f29c3.js" as="script">
<link rel="preload" href="/1.1509b875.js" as="script">
<link rel="preload" href="/2.da43fd8b.js" as="script">
<link rel="preload" href="/4.db0f1a5a.js" as="script">
<link rel="preload" href="/1be78505.d3e7d32c.js" as="script">
<link rel="preload" href="/28.252c0842.js" as="script">
<link rel="preload" href="/935f2afb.24783415.js" as="script">
<link rel="preload" href="/17896441.8ab7f4e3.js" as="script">
<link rel="preload" href="/dbfd487c.452a6268.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img class="navbar__logo" src="/images/isaacscript-logo.png"><strong class="navbar__title">IsaacScript</strong></a><a class="navbar__item navbar__link" href="/docs/features">Docs</a></div><div class="navbar__items navbar__items--right"><a href="https://discord.gg/KapmKQ2gUD" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Discord</a><a href="https://github.com/IsaacScript/isaacscript" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><a href="https://wofsauge.github.io/IsaacDocs/rep/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">API Docs</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2aTZ"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_BsTx">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_BsTx">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img class="navbar__logo" src="/images/isaacscript-logo.png"><strong class="navbar__title">IsaacScript</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/features">Docs</a></li><li class="menu__list-item"><a href="https://discord.gg/KapmKQ2gUD" target="_blank" rel="noopener noreferrer" class="menu__link">Discord</a></li><li class="menu__list-item"><a href="https://github.com/IsaacScript/isaacscript" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li><li class="menu__list-item"><a href="https://wofsauge.github.io/IsaacDocs/rep/" target="_blank" rel="noopener noreferrer" class="menu__link">API Docs</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_2gpo"><div class="docSidebarContainer_3_JD" role="complementary"><div class="sidebar_2urC"><div class="menu menu--responsive menu_5FrY"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_Dm3K" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/features">Features</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/right-for-me">Is IsaacScript Right for Me?</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/getting-started">Getting Started</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/discord">Discord</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/what-is-isaacscript-doing">What is IsaacScript Doing?</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/directory-structure">Project Directory Structure</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/javascript-tutorial">JavaScript/TypeScript Tutorial</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/example-mod">Building an Example Mod</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" href="/docs/refactoring-mod">Refactoring an Example Mod</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/converting-lua-code">Converting Lua Code</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/publishing-to-the-workshop">Publishing to the Workshop</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/gotchas">Gotchas</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/function-signatures">Function Signatures</a></li></ul></div></div></div><main class="docMainContainer_3EyW"><div class="container padding-vert--lg docItemWrapper_1EkI"><div class="row"><div class="col docItemCol_2ASc"><div class="docItemContainer_3QWW"><article><header><h1 class="docTitle_1Lrw">Refactoring an Example Mod</h1></header><div class="markdown"><p>As your mod grows larger and larger, you will want to stay organized. Splitting up your mod into different files is easy with TypeScript by using <code>import</code> and <code>export</code>. There are many ways to structure a big mod, so think about a hierarchy that makes sense for you.</p><p>Let&#x27;s say that in our example mod, we want to add a few more custom items, so that the mod becomes an item pack. Before we continue to clutter our &quot;main.ts&quot; file, let&#x27;s refactor our code to keep things clean.</p><br><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="1-srcmaints"></a>1) src/main.ts<a aria-hidden="true" tabindex="-1" class="hash-link" href="#1-srcmaints" title="Direct link to heading">#</a></h2><p>We don&#x27;t want to have any logic in the &quot;main.ts&quot; file. This purpose of this file is to simply register the mod and glue together all of the callbacks.</p><div class="mdxCodeBlock_1XEh"><pre class="prism-code language-typescript codeBlock_222H"><button type="button" aria-label="Copy code to clipboard" class="copyButton_ujp3">Copy</button><a aria-label="Open code on playground" class="playgroundButton_3DKR" target="_blank" href="/play/#code/PTAEBEFMDMEsDtKlgWwA4HsBOAXAzgFCqa6gBUoAhnqJnjgKpoAmlOS0WGKoARAHTAAxpQA2ogEaUhAazzA6jFm0i8A3AQIhQAJUgBzWPUhZQOABZIUGZlrAAKAO7nYQ86EexxoFJRlJYHFA8cwxHUABXNGR4M0tQUSMgjGgfGxoMWIsrG2ChLEhIWIQ4q0oSlCKIgEoCIUz6UH0CooBhSnhmUSQAXl0DJJMAWRt7XmbC+HbO7t4AGlAARmqNO37DY1MRcSlZQgm2jq7IfgBBZmZ2nekZexHLsUkbvH4h1oB9AAUAeQBlABV3gxPuBTv8AKILRRMVjsfi+BArNb-b7gb6gAC0oHOzFA9WYHGwoEQ4W2Tz2oEsBU02k+WAQQQ6MUCsDEsAAXmxYJkfJA8HhKPokDgMKU+KIMPp+DgAB44XigODdAgASQF0n4UAkEX0vxw9Pg+jG-3iAHEWrFpsc0rijMycKzEuzIMx+LwVkA">Playground</a><code class="codeBlockLines_3zpG" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// Define imports</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> postUpdate </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;./callbacks/postUpdate&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Register the mod</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// (which will make it show up in the list of mods on the mod screen in the main menu)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> greenCandle </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:#d73a49">RegisterMod</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;greenCandle&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Register callbacks</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">greenCandle</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access maybe-class-name" style="color:#d73a49">AddCallback</span><span class="token punctuation" style="color:#393A34">(</span><span class="token maybe-class-name">ModCallbacks</span><span class="token punctuation" style="color:#393A34">.</span><span class="token constant" style="color:#36acaa">MC_POST_UPDATE</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> postUpdate</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">main</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// TODO - Add code for new callbacks here</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Print an initialization message to the &quot;log.txt&quot; file</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token maybe-class-name">Isaac</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access maybe-class-name" style="color:#d73a49">DebugString</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;The Green Candle mod is initialized.&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span></div></code></pre></div><br><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="2-srcconstantsts"></a>2) src/constants.ts<a aria-hidden="true" tabindex="-1" class="hash-link" href="#2-srcconstantsts" title="Direct link to heading">#</a></h2><p>Before, we had a <code>greenCandleItemID</code> variable. This is a constant and will never change, so it belongs in its own &quot;constants.ts&quot; file. Furthermore, instead of having individual variables for every item ID, we can put them all in a &quot;CollectibleTypeCustom&quot; enum, which helps us stay more organized.</p><div class="mdxCodeBlock_1XEh"><pre class="prism-code language-typescript codeBlock_222H"><button type="button" aria-label="Copy code to clipboard" class="copyButton_ujp3">Copy</button><a aria-label="Open code on playground" class="playgroundButton_3DKR" target="_blank" href="/play/#code/KYDwDg9gTgLgBMAdgVwLZwMIQDbeAYxgEsAjPAFQE8xgNkBnGCdAbwCg5MB5AGR4FEM5AJIAhAQH0A4gCV+-AHISMAQQUARAXAC8cYfQCGB-ADopwGMJjBUwgCajKCg6mAAKAERSowJJgOIdngeAJQANGwAvkA">Playground</a><code class="codeBlockLines_3zpG" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">enum</span><span class="token plain"> </span><span class="token maybe-class-name">CollectibleTypeCustom</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token constant" style="color:#36acaa">COLLECTIBLE_GREEN_CANDLE</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token maybe-class-name">Isaac</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access maybe-class-name" style="color:#d73a49">GetItemIdByName</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Green Candle&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></div></code></pre></div><br><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="3-srccallbackspostupdatets"></a>3) src/callbacks/postUpdate.ts<a aria-hidden="true" tabindex="-1" class="hash-link" href="#3-srccallbackspostupdatets" title="Direct link to heading">#</a></h2><p>Each callback can have its own dedicated file in the &quot;callbacks&quot; directory. Here&#x27;s the code for &quot;postUpdate.ts&quot;:</p><div class="mdxCodeBlock_1XEh"><pre class="prism-code language-typescript codeBlock_222H"><button type="button" aria-label="Copy code to clipboard" class="copyButton_ujp3">Copy</button><a aria-label="Open code on playground" class="playgroundButton_3DKR" target="_blank" href="/play/#code/JYWwDg9gTgLgBAKjgQwM5wOZQKbYHYDCyeAJgDbZwBmUEIcARAHRMD0wM2IqrWuhxctgYBuAFBjsAD0ixqAVzwBjGMAh44IZMDwAKAJQAuOADcIwEnADeYuJhz4ipCkyUALbEoDWAQTBgyAE8AUSoqTxgDcTtWVjgAFQB5ABFEuABaOB8SSyUIEkoqaDg8bAB3OA4udA8cMQBfIA">Playground</a><code class="codeBlockLines_3zpG" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> greenCandle </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;../items/greenCandle&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  greenCandle</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">checkApplyEffect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// TODO - Add code for new items here</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></div></code></pre></div><br><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="4-srcitemsgreencandlets"></a>4) src/items/greenCandle.ts<a aria-hidden="true" tabindex="-1" class="hash-link" href="#4-srcitemsgreencandlets" title="Direct link to heading">#</a></h2><p>Each item can have its own dedicated file in the &quot;items&quot; directory.</p><div class="mdxCodeBlock_1XEh"><pre class="prism-code language-typescript codeBlock_222H"><button type="button" aria-label="Copy code to clipboard" class="copyButton_ujp3">Copy</button><a aria-label="Open code on playground" class="playgroundButton_3DKR" target="_blank" href="/play/#code/JYWwDg9gTgLgBAbzgYQgGzQUwMY2AIywBUBPMTZAVwGcYIQ4BfOAMynrgCIA6bgemwQAdrQCGQmNU4BuAFCzMAD0ixWlIbmDC42ABY4A1gEEwYNCQCiLFjhgAKAJQAuOADcIwACaJZcHcNo4AHNREEw4AF44AHFQzEc5P0EReCFKEAAFNFESTChqSOC47mjMGAA5dKycvOoE31ZoODsseGBCgAZpOHaAHjg0zOzc-O7gAGpxhx8-JID4MxqoQoBJalFRbBKy6pG7YAdE2eAWZsWRuABCCKi0jDgAMge4c7zuAAlRalQMWwIsOw-LCaQiYUjkKi0ejcZAAeQAMvCLMgiCsAEJIgD60QAShYLOVMcgjOUACJIhzTBANWZwUSmcxWGy4OyvKCHGlMBqMWQ82QsdSabT0syWay2VnDPIuCwSYAwEi7PJUhosJp2ZKBTByhVwCCnNYbLalGA4iD0WV4PCYOqUmbHU52ai6CCUNCeEyipm2IgQS3ykh2bVWkh26m0vzBgPcIyeTwZDzUYR2f0KnGYFiSpYOAA0cAAjB0Onm2dxSaFREFMBzaTy-Dy+QKNHhtM7Xe7PYzxbhfanA1GFTKdaH7Xw+FwQKIYLpuFBxJ56HYAKxFhycYLavJTm10uBzoQLhiDfB5OAnmAAd0w2oLdIPcBXHQaY7gRF0wAKH93+bg48fOl0cRsEwPMmg6bgACYAFIGigMpKCgIQ4AHEhuDWAA1N0hC3UFZUwEBA2mJ44EnadZ3nRdH2mG4onzORGCAA">Playground</a><code class="codeBlockLines_3zpG" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token maybe-class-name">CollectibleTypeCustom</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;../constants&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">checkApplyEffect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> game </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:#d73a49">Game</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> numPlayers </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> game</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access maybe-class-name" style="color:#d73a49">GetNumPlayers</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> numPlayers</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i</span><span class="token operator" style="color:#393A34">++</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> player </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token maybe-class-name">Isaac</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access maybe-class-name" style="color:#d73a49">GetPlayer</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">player </span><span class="token operator" style="color:#393A34">!==</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">null</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> player</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access maybe-class-name" style="color:#d73a49">HasCollectible</span><span class="token punctuation" style="color:#393A34">(</span><span class="token maybe-class-name">CollectibleTypeCustom</span><span class="token punctuation" style="color:#393A34">.</span><span class="token constant" style="color:#36acaa">COLLECTIBLE_GREEN_CANDLE</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token function" style="color:#d73a49">applyEffect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">player</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">applyEffect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">player</span><span class="token parameter punctuation" style="color:#393A34">:</span><span class="token parameter"> EntityPlayer</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> entity </span><span class="token keyword" style="color:#00009f">of</span><span class="token plain"> </span><span class="token maybe-class-name">Isaac</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access maybe-class-name" style="color:#d73a49">GetRoomEntities</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">shouldApplyEffectToEntity</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">entity</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      entity</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access maybe-class-name" style="color:#d73a49">AddPoison</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function maybe-class-name" style="color:#d73a49">EntityRef</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">player</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">100</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> player</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access maybe-class-name">Damage</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">shouldApplyEffectToEntity</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">entity</span><span class="token parameter punctuation" style="color:#393A34">:</span><span class="token parameter"> Entity</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// &quot;math.random(500)&quot; generates a random number between 1 and 500</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// This is a 1 / 500 chance, or 0.2%</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> entity</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access maybe-class-name" style="color:#d73a49">IsVulnerableEnemy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> math</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">random</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">500</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></div></code></pre></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="5-done"></a>5) Done!<a aria-hidden="true" tabindex="-1" class="hash-link" href="#5-done" title="Direct link to heading">#</a></h2><p>Now, our project looks like this:</p><div class="mdxCodeBlock_1XEh"><pre class="prism-code language-typescript codeBlock_222H"><button type="button" aria-label="Copy code to clipboard" class="copyButton_ujp3">Copy</button><a aria-label="Open code on playground" class="playgroundButton_3DKR" target="_blank" href="/play/#code/M4Jwxg9AUIOKSACkcAEBbAhgSwHYDoAuxYFEwB7TYXVTfPA+JMVAGyYCNUwBrYaQIFJEBgFFIiABxIUAqiIAmqXAFNaUYUnQLkPKAKFEA5iHnzMAYSrSmi-EA">Playground</a><code class="codeBlockLines_3zpG" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">src</span><span class="token operator" style="color:#393A34">/</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">â”œâ”€â”€ main</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">ts</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">â”œâ”€â”€ constants</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">ts</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">â”œâ”€â”€ callbacks</span><span class="token operator" style="color:#393A34">/</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">â”‚   â””â”€â”€ postUpdate</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">ts</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">â””â”€â”€ items</span><span class="token operator" style="color:#393A34">/</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    â””â”€â”€ greenCandle</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">ts</span></div></code></pre></div></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/IsaacScript/isaacscript.github.io/edit/main/docs/refactoring-mod.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/example-mod"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Building an Example Mod</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/converting-lua-code"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Converting Lua Code Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_3SO_"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#1-srcmaints" class="table-of-contents__link">1) src/main.ts</a></li><li><a href="#2-srcconstantsts" class="table-of-contents__link">2) src/constants.ts</a></li><li><a href="#3-srccallbackspostupdatets" class="table-of-contents__link">3) src/callbacks/postUpdate.ts</a></li><li><a href="#4-srcitemsgreencandlets" class="table-of-contents__link">4) src/items/greenCandle.ts</a></li><li><a href="#5-done" class="table-of-contents__link">5) Done!</a></li></ul></div></div></div></div></main></div></div></div>
<script src="/styles.a1659319.js"></script>
<script src="/runtime~main.8369a129.js"></script>
<script src="/main.2a6f29c3.js"></script>
<script src="/1.1509b875.js"></script>
<script src="/2.da43fd8b.js"></script>
<script src="/4.db0f1a5a.js"></script>
<script src="/1be78505.d3e7d32c.js"></script>
<script src="/28.252c0842.js"></script>
<script src="/935f2afb.24783415.js"></script>
<script src="/17896441.8ab7f4e3.js"></script>
<script src="/dbfd487c.452a6268.js"></script>
</body>
</html>