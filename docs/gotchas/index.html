<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.66">
<script src="/js/hotkey.js"></script><title data-react-helmet="true">Gotchas | IsaacScript</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docusaurus_language" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Gotchas | IsaacScript"><meta data-react-helmet="true" name="description" content="This page lists several &quot;gotchas&quot; or things that might be weird about IsaacScript."><meta data-react-helmet="true" property="og:description" content="This page lists several &quot;gotchas&quot; or things that might be weird about IsaacScript."><meta data-react-helmet="true" property="og:url" content="https://isaacscript.github.io/docs/gotchas"><link data-react-helmet="true" rel="shortcut icon" href="/images/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://isaacscript.github.io/docs/gotchas"><link rel="stylesheet" href="/styles.b1123bec.css">
<link rel="stylesheet" href="/main.103933fb.css">
<link rel="stylesheet" href="/1be78505.0edf629a.css">
<link rel="preload" href="/styles.a1659319.js" as="script">
<link rel="preload" href="/runtime~main.e322ed83.js" as="script">
<link rel="preload" href="/main.2a6f29c3.js" as="script">
<link rel="preload" href="/1.1509b875.js" as="script">
<link rel="preload" href="/2.da43fd8b.js" as="script">
<link rel="preload" href="/4.db0f1a5a.js" as="script">
<link rel="preload" href="/1be78505.d3e7d32c.js" as="script">
<link rel="preload" href="/28.252c0842.js" as="script">
<link rel="preload" href="/935f2afb.24783415.js" as="script">
<link rel="preload" href="/17896441.8ab7f4e3.js" as="script">
<link rel="preload" href="/b2dbe049.90994bf3.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img class="navbar__logo" src="/images/isaacscript-logo.png"><strong class="navbar__title">IsaacScript</strong></a><a class="navbar__item navbar__link" href="/docs/features">Docs</a></div><div class="navbar__items navbar__items--right"><a href="https://discord.gg/KapmKQ2gUD" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Discord</a><a href="https://github.com/IsaacScript/isaacscript" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><a href="https://wofsauge.github.io/IsaacDocs/rep/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">API Docs</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2aTZ"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_BsTx">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_BsTx">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img class="navbar__logo" src="/images/isaacscript-logo.png"><strong class="navbar__title">IsaacScript</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/features">Docs</a></li><li class="menu__list-item"><a href="https://discord.gg/KapmKQ2gUD" target="_blank" rel="noopener noreferrer" class="menu__link">Discord</a></li><li class="menu__list-item"><a href="https://github.com/IsaacScript/isaacscript" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li><li class="menu__list-item"><a href="https://wofsauge.github.io/IsaacDocs/rep/" target="_blank" rel="noopener noreferrer" class="menu__link">API Docs</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_2gpo"><div class="docSidebarContainer_3_JD" role="complementary"><div class="sidebar_2urC"><div class="menu menu--responsive menu_5FrY"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_Dm3K" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/features">Features</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/right-for-me">Is IsaacScript Right for Me?</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/getting-started">Getting Started</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/discord">Discord</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/what-is-isaacscript-doing">What is IsaacScript Doing?</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/directory-structure">Project Directory Structure</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/javascript-tutorial">JavaScript/TypeScript Tutorial</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/example-mod">Building an Example Mod</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/refactoring-mod">Refactoring an Example Mod</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/converting-lua-code">Converting Lua Code</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/publishing-to-the-workshop">Publishing to the Workshop</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" href="/docs/gotchas">Gotchas</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/function-signatures">Function Signatures</a></li></ul></div></div></div><main class="docMainContainer_3EyW"><div class="container padding-vert--lg docItemWrapper_1EkI"><div class="row"><div class="col docItemCol_2ASc"><div class="docItemContainer_3QWW"><article><header><h1 class="docTitle_1Lrw">Gotchas</h1></header><div class="markdown"><p>This page lists several &quot;gotchas&quot; or things that might be weird about IsaacScript.</p><br><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="extending-enums----custom-enums"></a>Extending Enums --&gt; Custom Enums<a aria-hidden="true" tabindex="-1" class="hash-link" href="#extending-enums----custom-enums" title="Direct link to heading">#</a></h3><p>In your Lua mods, you may have extended the game&#x27;s built-in enums. For example:</p><div class="mdxCodeBlock_1XEh"><pre class="prism-code language-lua codeBlock_222H"><button type="button" aria-label="Copy code to clipboard" class="copyButton_ujp3">Copy</button><code class="codeBlockLines_3zpG" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">-- At the top of your Lua mod:</span></div><div class="token-line" style="color:#393A34"><span class="token plain">CollectibleType.COLLECTIBLE_MY_CUSTOM_ITEM = Isaac.GetItemIdByName(&quot;My Custom Item&quot;)</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">-- Elsewhere in the code:</span></div><div class="token-line" style="color:#393A34"><span class="token plain">if (</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  player:HasCollectible(CollectibleType.COLLECTIBLE_MY_CUSTOM_ITEM)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  and player:HasCollectible(CollectibleType.COLLECTIBLE_EPIC_FETUS)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">) then</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  -- Handle the specific synergy with My Custom Item + Epic Fetus</span></div><div class="token-line" style="color:#393A34"><span class="token plain">end</span></div></code></pre></div><p>In TypeScript, you cannot extend existing enums for safety reasons. Instead, create your own enum:</p><div class="mdxCodeBlock_1XEh"><pre class="prism-code language-typescript codeBlock_222H"><button type="button" aria-label="Copy code to clipboard" class="copyButton_ujp3">Copy</button><a aria-label="Open code on playground" class="playgroundButton_3DKR" target="_blank" href="/play/#code/PTAEEEBdUgLBTGB7ADqJAzUBPJBXAJ1ABVsV4BlAYwIEsVoBbJAEwC4AoeAOz0dADCSADbD4VSLQBGY0uQF4AzpCT8A3h1CCA8gBldAUQHEAkgCFDAfQCyATUsCAqhWLbrlk8QPXQAXlAmigCGQVQAdADi8JAmkPCMJixm2AByQYzwABQARNbYgkoq-LHx2QCUADQcAL4cHCCgBsKK8ADuCASItNwwCKBUrPCctFiZmqAowkHY8ARhABJBikKi4pIyWStiEtKyZPAKyqphAnqGxuZWdg7Oru6e3mWgAGTP45PTswtLW2u7myJtus9uQTmcjKYLAZLAYAAomASWABiBmIzjKHCeGi0DUW3BYYl6iEU5CoI1oVFAimw3FmAHN8q1aHBQHkCkdinF+ABqRooCmgJHRJQ1IA">Playground</a><code class="codeBlockLines_3zpG" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// At the top of your TypeScript mod:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">enum</span><span class="token plain"> </span><span class="token maybe-class-name">CollectibleTypeCustom</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token constant" style="color:#36acaa">COLLECTIBLE_MY_CUSTOM_ITEM</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token maybe-class-name">Isaac</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access maybe-class-name" style="color:#d73a49">GetItemIdByName</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;My Custom Item&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Elsewhere in the code:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  player</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access maybe-class-name" style="color:#d73a49">HasCollectible</span><span class="token punctuation" style="color:#393A34">(</span><span class="token maybe-class-name">CollectibleTypeCustom</span><span class="token punctuation" style="color:#393A34">.</span><span class="token constant" style="color:#36acaa">COLLECTIBLE_MY_CUSTOM_ITEM</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  player</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access maybe-class-name" style="color:#d73a49">HasCollectible</span><span class="token punctuation" style="color:#393A34">(</span><span class="token maybe-class-name">CollectibleType</span><span class="token punctuation" style="color:#393A34">.</span><span class="token constant" style="color:#36acaa">COLLECTIBLE_EPIC_FETUS</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Handle the specific synergy with My Custom Item + Epic Fetus</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></div></code></pre></div><p>Note that you don&#x27;t have to worry about polluting the global namespace: due to how the transpiler works, your enum will be local to your own project.</p><br><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="int-and-float"></a><code>int</code> and <code>float</code><a aria-hidden="true" tabindex="-1" class="hash-link" href="#int-and-float" title="Direct link to heading">#</a></h3><p>In Lua, there is only one type of number. (The programming language doesn&#x27;t differentiate between integers, floats, etc.)</p><p>TypeScript works the same way as Lua. There is only one type of number: <code>number</code>.</p><p>However, the official Isaac API documentation uses integers and floats. For example, this is the entry for the <code>EntityPlayer:AddCollectible()</code> function:</p><div class="mdxCodeBlock_1XEh"><pre class="prism-code language-c++ codeBlock_222H"><button type="button" aria-label="Copy code to clipboard" class="copyButton_ujp3">Copy</button><code class="codeBlockLines_3zpG" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">AddCollectible (CollectibleType Type, integer Charge, boolean AddConsumables)</span></div></code></pre></div><p>In order to more closely match the API, the TypeScript API definitions use <code>int</code> and <code>float</code> types. Thus, the above function is declared like this:</p><div class="mdxCodeBlock_1XEh"><pre class="prism-code language-typescript codeBlock_222H"><button type="button" aria-label="Copy code to clipboard" class="copyButton_ujp3">Copy</button><a aria-label="Open code on playground" class="playgroundButton_3DKR" target="_blank" href="/play/#code/IIExGEHsBtoUwMYBcCWAjeAKBN7PfACoCeADnAFwAEKAdkgDRUIAWAhgE4DmlN9TbMFFoBnAK4BbNhjgjqaSDDhtaASmoA3SChABuIA">Playground</a><code class="codeBlockLines_3zpG" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token function maybe-class-name" style="color:#d73a49">AddCollectible</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">collectibleType</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> int</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> charge</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> int</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> addConsumables</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">boolean</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token punctuation" style="color:#393A34">;</span></div></code></pre></div><p>If you want, you can use the <code>int</code> and <code>float</code> types in your own code too (instead of just using <code>number</code>, like you would in other typical TypeScript code). But if you do use <code>int</code> and <code>float</code>, be aware that they are simply aliases for <code>number</code>, so they don&#x27;t provide any actual type safety.</p><p>In other words, it is possible to do this, so beware:</p><div class="mdxCodeBlock_1XEh"><pre class="prism-code language-typescript codeBlock_222H"><button type="button" aria-label="Copy code to clipboard" class="copyButton_ujp3">Copy</button><a aria-label="Open code on playground" class="playgroundButton_3DKR" target="_blank" href="/play/#code/PTAEHEEsDcFNQC4At4AcA2BDAnrATqJqAMqYAmoA8gHaQD21AUBjvgHQCCZZAwneulgBjBJABGggBR8Bw0RNgAVbKlhselADKaAoj0UBJAEK6A+sQ4ARU5QByBuwBpQABmcAzTOgDOsAJQA3IyMIKAAYpDUFHQArgigSHQA7qAAtpjU2CTkVLQM3ogoWUiYcIyC8dQxqaRkNPTUBQC8oCy4eGzgsAgygiLigrbV0vx98oLKqupauvrGZhbWdg62gSFgVTXk9fmgkAXUyYTUoABEkQinoEmQyISg0F4x8HTuZwCMp8GbtTuNoABqFouNgAViCoR+2zy-32oG8ogExzOF1OzjEcVAhxStwSmAKREe6GeoFeHzBX1CiiQcLhRAxAHNjhRJrBiEI8JBUPEkgwAOTxISYBBCJCFOHuOgEbCxACEQA">Playground</a><code class="codeBlockLines_3zpG" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// Give the player a Sad Onion</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">player</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access maybe-class-name" style="color:#d73a49">AddCollectible</span><span class="token punctuation" style="color:#393A34">(</span><span class="token maybe-class-name">CollectibleType</span><span class="token punctuation" style="color:#393A34">.</span><span class="token constant" style="color:#36acaa">COLLECTIBLE_SAD_ONION</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Find out how many Sad Onions they have</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> numSadOnions </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> player</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access maybe-class-name" style="color:#d73a49">GetCollectibleNum</span><span class="token punctuation" style="color:#393A34">(</span><span class="token maybe-class-name">CollectibleType</span><span class="token punctuation" style="color:#393A34">.</span><span class="token constant" style="color:#36acaa">COLLECTIBLE_SAD_ONION</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// numSadOnions is now an &quot;int&quot; with a value of &quot;1&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">numSadOnions </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.5</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// numSadOnions is still an &quot;int&quot;, but now it has a value of &quot;1.5&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// This is a bug and TypeScript won&#x27;t catch this for you!</span></div></code></pre></div><br><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="vector-operators"></a>Vector Operators<a aria-hidden="true" tabindex="-1" class="hash-link" href="#vector-operators" title="Direct link to heading">#</a></h3><p>In Isaac modding, working with Vectors is common. For example, you might want to double the speed of an enemy projectile. Doing this in Lua is simple:</p><div class="mdxCodeBlock_1XEh"><pre class="prism-code language-lua codeBlock_222H"><button type="button" aria-label="Copy code to clipboard" class="copyButton_ujp3">Copy</button><code class="codeBlockLines_3zpG" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">-- Lua code</span></div><div class="token-line" style="color:#393A34"><span class="token plain">-- Double the speed of the projectile</span></div><div class="token-line" style="color:#393A34"><span class="token plain">projectile.Velocity = projectile.Velocity * 2</span></div></code></pre></div><p>This code is the actually the same as writing:</p><div class="mdxCodeBlock_1XEh"><pre class="prism-code language-lua codeBlock_222H"><button type="button" aria-label="Copy code to clipboard" class="copyButton_ujp3">Copy</button><code class="codeBlockLines_3zpG" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">-- Lua code</span></div><div class="token-line" style="color:#393A34"><span class="token plain">-- Double the speed of the projectile</span></div><div class="token-line" style="color:#393A34"><span class="token plain">projectile.Velocity = projectile.Velocity:__mul(2)</span></div></code></pre></div><p>Under the hood, Lua converts the first code snippet to the second code snippet automatically. This is because it understands that <code>__mul</code> is a special operator method. Most people write code in the first way instead of the second way, because it is more convenient.</p><p>In TypeScript, we unfortunately cannot code in the first way due to <a href="https://typescripttolua.github.io/docs/advanced/writing-declarations/#operator-overloads" target="_blank" rel="noopener noreferrer">limitations in TypeScriptToLua</a>. Since operator overloads will not work, we can instead just call the methods directly.</p><p>Here&#x27;s an example:</p><div class="mdxCodeBlock_1XEh"><pre class="prism-code language-lua codeBlock_222H"><button type="button" aria-label="Copy code to clipboard" class="copyButton_ujp3">Copy</button><code class="codeBlockLines_3zpG" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">-- Lua code</span></div><div class="token-line" style="color:#393A34"><span class="token plain">local vector = Vector(1, 1) * 5 + 2</span></div></code></pre></div><div class="mdxCodeBlock_1XEh"><pre class="prism-code language-typescript codeBlock_222H"><button type="button" aria-label="Copy code to clipboard" class="copyButton_ujp3">Copy</button><a aria-label="Open code on playground" class="playgroundButton_3DKR" target="_blank" href="/play/#code/PTAEBUE8AcFMGUDGAnAltALqRB7AJrAFC4B2AzlgG6yIY7KgC8oAajXcgBQCMANKNwCUAOgD6ogLYBXADacArCPEBDPHk4AmQQG4gA">Playground</a><code class="codeBlockLines_3zpG" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// TypeScript code</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> vector </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:#d73a49">Vector</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">__mul</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">__add</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span></div></code></pre></div><p>If you want, you can also use the convenience methods of &quot;add&quot;, &quot;mul&quot;, and so forth, which will transpile to the same thing. For example:</p><div class="mdxCodeBlock_1XEh"><pre class="prism-code language-typescript codeBlock_222H"><button type="button" aria-label="Copy code to clipboard" class="copyButton_ujp3">Copy</button><a aria-label="Open code on playground" class="playgroundButton_3DKR" target="_blank" href="/play/#code/PTAEBUE8AcFMGUDGAnAltALqRB7AJrAFC4B2AzlgG6yIY7KgC8oAajXcgBQCMANKNwCUAOgC2AVwA2nAKwiAhnjycATIIDcQA">Playground</a><code class="codeBlockLines_3zpG" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// TypeScript code</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> vector </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:#d73a49">Vector</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">mul</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">add</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span></div></code></pre></div><p>If you are converting Lua code, make sure to account for order of operations:</p><div class="mdxCodeBlock_1XEh"><pre class="prism-code language-lua codeBlock_222H"><button type="button" aria-label="Copy code to clipboard" class="copyButton_ujp3">Copy</button><code class="codeBlockLines_3zpG" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">-- Lua code</span></div><div class="token-line" style="color:#393A34"><span class="token plain">local vector = Vector(1, 1) + Vector(3, 3) * 6</span></div><div class="token-line" style="color:#393A34"><span class="token plain">-- (multiplication happens before addition)</span></div></code></pre></div><div class="mdxCodeBlock_1XEh"><pre class="prism-code language-typescript codeBlock_222H"><button type="button" aria-label="Copy code to clipboard" class="copyButton_ujp3">Copy</button><a aria-label="Open code on playground" class="playgroundButton_3DKR" target="_blank" href="/play/#code/PTAEBUE8AcFMGUDGAnAltALqRB7AJrAFAA2sWAbrIhjsqALygBqVNyAFAMwA0onAlADoA+sIC2AV2LsAbENEBDPHnYtqtdgEZem-gG4gA">Playground</a><code class="codeBlockLines_3zpG" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// TypeScript code</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> vector </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:#d73a49">Vector</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">__mul</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">6</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">__add</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function maybe-class-name" style="color:#d73a49">Vector</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span></div></code></pre></div><p>Note that if you really need to, you can restore operator overloading for Vectors by creating a <a href="https://medium.com/@KevinBGreene/surviving-the-typescript-ecosystem-branding-and-type-tagging-6cf6e516523d" target="_blank" rel="noopener noreferrer">branded type</a> with something along the lines of:</p><div class="mdxCodeBlock_1XEh"><pre class="prism-code language-typescript codeBlock_222H"><button type="button" aria-label="Copy code to clipboard" class="copyButton_ujp3">Copy</button><a aria-label="Open code on playground" class="playgroundButton_3DKR" target="_blank" href="/play/#code/C4TwDgpgBAahDGwD2AnKBeKA7ArgWwCMI0AyKAbygH0qBLLYAIRQEMsATALijZCgF8A3EA">Playground</a><code class="codeBlockLines_3zpG" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> </span><span class="token maybe-class-name">Vector</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">number</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> __intBrand</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">any</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span></div></code></pre></div><p>But this is <strong>not recommend</strong> because it destroys type-safety.</p><br><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="using-tearflags--bitset128"></a>Using TearFlags / BitSet128<a aria-hidden="true" tabindex="-1" class="hash-link" href="#using-tearflags--bitset128" title="Direct link to heading">#</a></h3><p>First, see the section above on <a href="#vector-operators">vector operators</a>, which explains that you can&#x27;t use Lua&#x27;s operator overloading functionality in TypeScript.</p><p>In the Repentance DLC, TearFlags were changed from an integer to a new <code>BitSet128</code> object. (This is because Lua can only handle 64-bit numbers, and the data type of TearFlags had to change to a 128-bit integer because of all of the new tear effects that were introduced.)</p><p>Previously, in Afterbirth+ code, you would add spectral tears to the player like so:</p><div class="mdxCodeBlock_1XEh"><pre class="prism-code language-typescript codeBlock_222H"><button type="button" aria-label="Copy code to clipboard" class="copyButton_ujp3">Copy</button><a aria-label="Open code on playground" class="playgroundButton_3DKR" target="_blank" href="/play/#code/MYewdgzgLgBADgGwIYE8CmAnGBeGBJCJJYAOgHE0oAFZdDACgAYBKAbgChFVMSAVNJBgBiyAOYQYAH1z9BIpOL4BRAIIAlAPoBlKkoDCvNSoAyrIA">Playground</a><code class="codeBlockLines_3zpG" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> player </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token maybe-class-name">Isaac</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access maybe-class-name" style="color:#d73a49">GetPlayer</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">player</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access maybe-class-name">TearFlags</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|=</span><span class="token plain"> </span><span class="token maybe-class-name">TearFlags</span><span class="token punctuation" style="color:#393A34">.</span><span class="token constant" style="color:#36acaa">TEAR_SPECTRAL</span><span class="token punctuation" style="color:#393A34">;</span></div></code></pre></div><p>Now, since TearFlags are a <code>BitSet128</code> object, we can&#x27;t directly use bitwise operators anymore. Instead, use the provided <a href="https://github.com/IsaacScript/isaac-typescript-definitions/blob/main/typings/BitSet128.d.ts" target="_blank" rel="noopener noreferrer">convenience methods</a> like so:</p><div class="mdxCodeBlock_1XEh"><pre class="prism-code language-typescript codeBlock_222H"><button type="button" aria-label="Copy code to clipboard" class="copyButton_ujp3">Copy</button><a aria-label="Open code on playground" class="playgroundButton_3DKR" target="_blank" href="/play/#code/MYewdgzgLgBADgGwIYE8CmAnGBeGBJCJJYAOgHE0oAFZdDACgAYBKAbgChFVMSAVNJBgBiyAOYQc8Wj36CRScSQBGIBrOFiIfAKIBBAEoB9AMpVtAYV77dAGTZA">Playground</a><code class="codeBlockLines_3zpG" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> player </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token maybe-class-name">Isaac</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access maybe-class-name" style="color:#d73a49">GetPlayer</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">player</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access maybe-class-name">TearFlags</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> player</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access maybe-class-name">TearFlags</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">bor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token maybe-class-name">TearFlags</span><span class="token punctuation" style="color:#393A34">.</span><span class="token constant" style="color:#36acaa">TEAR_SPECTRAL</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span></div></code></pre></div><p>(<code>bor</code> stands for &quot;binary OR&quot;.)</p><p>As a reminder, remember that to remove a tear flag, you need to use a <a href="https://stackoverflow.com/questions/3920307/how-can-i-remove-a-flag-in-c" target="_blank" rel="noopener noreferrer">bitwise AND with a bitwise NOT</a>. In Afterbirth+, that would look like this:</p><div class="mdxCodeBlock_1XEh"><pre class="prism-code language-typescript codeBlock_222H"><button type="button" aria-label="Copy code to clipboard" class="copyButton_ujp3">Copy</button><a aria-label="Open code on playground" class="playgroundButton_3DKR" target="_blank" href="/play/#code/PTAECUFMFsHsDdKgM4AdIGMAuAnAhgDahaR47KgBmOs0xAFkqgXgJ6Q4BQGsAdsllDM2HUAF5QASWR48GAHQBxSFgAKLdjgAUABgCUAbk7DN8gCqkcAMRYBzCgDIJAPwtkbee+YCiAQXAA+gDKqt4AwmbgvgAyBkA">Playground</a><code class="codeBlockLines_3zpG" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// Remove spectral tears from the player</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> player </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token maybe-class-name">Isaac</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access maybe-class-name" style="color:#d73a49">GetPlayer</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">player</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access maybe-class-name">TearFlags</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;=</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">~</span><span class="token maybe-class-name">TearFlags</span><span class="token punctuation" style="color:#393A34">.</span><span class="token constant" style="color:#36acaa">TEAR_SPECTRAL</span><span class="token punctuation" style="color:#393A34">;</span></div></code></pre></div><p>But now in Repentance, it looks like this:</p><div class="mdxCodeBlock_1XEh"><pre class="prism-code language-typescript codeBlock_222H"><button type="button" aria-label="Copy code to clipboard" class="copyButton_ujp3">Copy</button><a aria-label="Open code on playground" class="playgroundButton_3DKR" target="_blank" href="/play/#code/PTAECUFMFsHsDdKgM4AdIGMAuAnAhgDahaR47KgBmOs0xAFkqgXgJ6Q4BQGsAdsllDM2HUAF5QASWR48GAHQBxSFgAKLdjgAUABgCUAbk7DN8gCqkcAMRYBzChJMdzlm3nvyARnl4ATLQB+FmRuHmYAogCC4AD6AMqq4QDCZuCRADKGQA">Playground</a><code class="codeBlockLines_3zpG" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// Remove spectral tears from the player</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> player </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token maybe-class-name">Isaac</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access maybe-class-name" style="color:#d73a49">GetPlayer</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">player</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access maybe-class-name">TearFlags</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> player</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access maybe-class-name">TearFlags</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">band</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">~</span><span class="token maybe-class-name">TearFlags</span><span class="token punctuation" style="color:#393A34">.</span><span class="token constant" style="color:#36acaa">TEAR_SPECTRAL</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span></div></code></pre></div><p>(<code>band</code> stands for &quot;binary AND&quot;.)</p><br><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="using-json"></a>Using JSON<a aria-hidden="true" tabindex="-1" class="hash-link" href="#using-json" title="Direct link to heading">#</a></h3><p>Isaac mods are allowed to write save data to the &quot;save1.dat&quot;, &quot;save2.dat&quot;, and &quot;save3.dat&quot; files (for save slot 1, save slot 2, and save slot 3, respectively). This is accomplished via the <code>Isaac.SaveModData()</code> function.</p><p>Any non-trivial mod will need to save many different variables. Since the <code>Isaac.SaveModData()</code> function takes a string instead of a Lua table, it is standard practice to convert a Lua table to a string using JSON.</p><p>Handily, Lua functions to accomplish this are provided with the game in the <code>C:\Program Files (x86)\Steam\steamapps\common\The Binding of Isaac Rebirth\resources\scripts\json.lua</code> file. All you have to do is require the file:</p><div class="mdxCodeBlock_1XEh"><pre class="prism-code language-lua codeBlock_222H"><button type="button" aria-label="Copy code to clipboard" class="copyButton_ujp3">Copy</button><code class="codeBlockLines_3zpG" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">-- Lua code</span></div><div class="token-line" style="color:#393A34"><span class="token plain">local json = require(&quot;json&quot;)</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">-- Register the mod</span></div><div class="token-line" style="color:#393A34"><span class="token plain">local Revelations = RegisterMod(&quot;Revelations&quot;, 1)</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">-- Define default values for the save data</span></div><div class="token-line" style="color:#393A34"><span class="token plain">local RevelationsSaveData = {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  currentHP = 3,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  currentNumFamiliars = 4,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  currentCharge = 10,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">}</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">local function saveModData()</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  local encodedData = json.encode(RevelationsSaveData)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  Isaac.SaveModData(Revelations, encodedData)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">end</span></div></code></pre></div><p>In TypeScript, we can directly call the Lua code in the same way. Note that IsaacScript automatically includes type definitions for the <code>json.lua</code> file, so you don&#x27;t have to worry about that part.</p><div class="mdxCodeBlock_1XEh"><pre class="prism-code language-typescript codeBlock_222H"><button type="button" aria-label="Copy code to clipboard" class="copyButton_ujp3">Copy</button><a aria-label="Open code on playground" class="playgroundButton_3DKR" target="_blank" href="/play/#code/PTAEBUE8AcFMGUDGAnAltALqRB7AJrAFCoC20OyWAVKAIYDOoAVvTgHagBmyOJoARC3b8A3IUIhQAJVgBzVPQyxkoDAAtYoEvkK42i6bABusADa0MqdowC8h+YuUBZfAAp+Mk+cvX+AGlAARgBKMQkwABFYTlQ2TQJOWgBXUywjWlMk2EZOClUNUHpaE1A8C1pdayxPMwsrfXhi2Ajy0DsAb0JQbCTkZFg2DAAJAAU20ABmPy6evoGMADkkkgAxWhJUU1RaZFtQABZp7sRe-sGAYTUd2U07QIAGaYBfMM4ktkQfDiKTFzwWjC0VzBUCdY5VUADXAEf6tOxCNgAOih+Fgrhq3nq9EaJgBtFCMwAkkVaIhETjYH88ejjLUvvQAiiYXiCU8gA">Playground</a><code class="codeBlockLines_3zpG" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// TypeScript code</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> json </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;json&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Register the mod</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token maybe-class-name">Revelations</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:#d73a49">RegisterMod</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Revelations&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Define default values for the save data</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token maybe-class-name">RevelationsSaveData</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  currentHP </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  currentNumFamiliars </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  currentCharge </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">saveModData</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> encodedData </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> json</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">encode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token maybe-class-name">RevelationsSaveData</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token maybe-class-name">Isaac</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access maybe-class-name" style="color:#d73a49">SaveModData</span><span class="token punctuation" style="color:#393A34">(</span><span class="token maybe-class-name">Revelations</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> encodedData</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></div></code></pre></div><br><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="iterating-over-enums"></a>Iterating Over Enums<a aria-hidden="true" tabindex="-1" class="hash-link" href="#iterating-over-enums" title="Direct link to heading">#</a></h3><p>Sometimes, you might want to iterate over an enum. For example, the following Lua code is a pretty good way to detect if the player is pressing any particular button on the keyboard:</p><div class="mdxCodeBlock_1XEh"><pre class="prism-code language-lua codeBlock_222H"><button type="button" aria-label="Copy code to clipboard" class="copyButton_ujp3">Copy</button><code class="codeBlockLines_3zpG" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">-- Lua code</span></div><div class="token-line" style="color:#393A34"><span class="token plain">-- &quot;Keyboard&quot; is an enum provided by the game</span></div><div class="token-line" style="color:#393A34"><span class="token plain">for keyName, keyCode in pairs(Keyboard) do</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  if Input.IsButtonPressed(keyCode, 0) then</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    Isaac.DebugString(&quot;Player pressed: &quot; .. keyName)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  end</span></div><div class="token-line" style="color:#393A34"><span class="token plain">end</span></div></code></pre></div><p>In TypeScript, it would be exactly like iterating over any other object:</p><div class="mdxCodeBlock_1XEh"><pre class="prism-code language-typescript codeBlock_222H"><button type="button" aria-label="Copy code to clipboard" class="copyButton_ujp3">Copy</button><a aria-label="Open code on playground" class="playgroundButton_3DKR" target="_blank" href="/play/#code/PTAEBUE8AcFMGUDGAnAltALqRB7AJrAFAigBEA0rJAEY4CGyepoqAzqHQHaiycCuAW1DRkOAG6oCeUNUigMAC1igA5nQFEAZjmSgAFLk6ssAbQDWVAHLrYAGlAXIAYXywAuqBybQAeWoArWEQMADpeDDRYVj1KGnpGAEoE0ABvQlAWbz0ASU5oPlDs1gAhAowcTgAFZCjWWDw9RxcCewAGJNT0jNAiujpEEIARWGo+FXgI1E4VPQADSoAbOkhYXRFa+oAuUAASFMdrDQBfWYSAbi6jwiOgA">Playground</a><code class="codeBlockLines_3zpG" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// TypeScript code</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// &quot;Keyboard&quot; is an enum provided by the game</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">keyName</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> keyCode</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">of</span><span class="token plain"> </span><span class="token known-class-name class-name">Object</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">entries</span><span class="token punctuation" style="color:#393A34">(</span><span class="token maybe-class-name">Keyboard</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token maybe-class-name">Input</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access maybe-class-name" style="color:#d73a49">IsButtonPressed</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">keyCode</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token maybe-class-name">Isaac</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access maybe-class-name" style="color:#d73a49">DebugString</span><span class="token punctuation" style="color:#393A34">(</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token template-string string" style="color:#e3116c">Player pressed: </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">${</span><span class="token template-string interpolation">keyName</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">}</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></div></code></pre></div><p>One important thing to note about this is that iterating over enums <strong>will not happen in order</strong>. This is because Lua&#x27;s <code>pairs()</code> function is designed to return table entries in a random order. If you need to get the contents of a Lua enum in order, then you will have to re-create that data as an array.</p><p>Furthermore, it is important that in the previous example, we are iterating over a &quot;normal&quot; enum provided by the game. You <strong>will not be able to iterate over your own enums</strong> in this way because of how TypeScriptToLua transpiles them. In order to increase performance, TypeScriptToLua creates a double mapping of key to value and value to key. For example:</p><div class="mdxCodeBlock_1XEh"><pre class="prism-code language-typescript codeBlock_222H"><button type="button" aria-label="Copy code to clipboard" class="copyButton_ujp3">Copy</button><a aria-label="Open code on playground" class="playgroundButton_3DKR" target="_blank" href="/play/#code/KYOwrgtgBAKsDOAXAouaBvAUFKB5AcslALxQCMANNrAOq4lQBMVOMAEgErJGkDMVAXyA">Playground</a><code class="codeBlockLines_3zpG" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">enum</span><span class="token plain"> </span><span class="token maybe-class-name">TestEnum</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token constant" style="color:#36acaa">ONE</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token constant" style="color:#36acaa">TWO</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token constant" style="color:#36acaa">THREE</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></div></code></pre></div><p>Will transpile to:</p><div class="mdxCodeBlock_1XEh"><pre class="prism-code language-lua codeBlock_222H"><button type="button" aria-label="Copy code to clipboard" class="copyButton_ujp3">Copy</button><code class="codeBlockLines_3zpG" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">local TestEnum = TestEnum or ({})</span></div><div class="token-line" style="color:#393A34"><span class="token plain">TestEnum.ONE = 1</span></div><div class="token-line" style="color:#393A34"><span class="token plain">TestEnum[TestEnum.ONE] = &quot;ONE&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">TestEnum.TWO = 2</span></div><div class="token-line" style="color:#393A34"><span class="token plain">TestEnum[TestEnum.TWO] = &quot;TWO&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token plain">TestEnum.THREE = 3</span></div><div class="token-line" style="color:#393A34"><span class="token plain">TestEnum[TestEnum.THREE] = &quot;THREE&quot;</span></div></code></pre></div><p>This means that if you want to iterate over your own enums in a way similar to the previous example, you have to use some type-checking:</p><div class="mdxCodeBlock_1XEh"><pre class="prism-code language-typescript codeBlock_222H"><button type="button" aria-label="Copy code to clipboard" class="copyButton_ujp3">Copy</button><a aria-label="Open code on playground" class="playgroundButton_3DKR" target="_blank" href="/play/#code/GYewTgBAFAxiB2BnALhA2gawKYE8A0EAbgIYA2ArlgLoQjAQDyARgFZYzIB0W8yYAllkRQAKkOQBReOQC2ASjkQA3gCgIEfvSjIcAByxRsORQEIAvGYgAiFAPgBzK4tXr1AejcQAkvfjgsEMgAFgFgWIRYYIgBMsS6uvwOiBAwYcTIWAAmEEw4ECJ6WADKqfy6yCIgADLkxGqucLyJlADc9QC+KvVeiMTEMJwAIlhM5PZFfIn2UAAGANK4AFwQACRKRu0zcm3qPX0Dw6Pjkw6zAGpklMtrJBRYm9sq7UA">Playground</a><code class="codeBlockLines_3zpG" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">key</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> value</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">of</span><span class="token plain"> </span><span class="token known-class-name class-name">Object</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">entries</span><span class="token punctuation" style="color:#393A34">(</span><span class="token maybe-class-name">TestEnum</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">type</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">key</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">!==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;string&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Ignore the reverse mappings created by TypeScriptToLua</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">continue</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token maybe-class-name">Isaac</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access maybe-class-name" style="color:#d73a49">DebugString</span><span class="token punctuation" style="color:#393A34">(</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token template-string string" style="color:#e3116c">Key: </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">${</span><span class="token template-string interpolation">key</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">}</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token maybe-class-name">Isaac</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access maybe-class-name" style="color:#d73a49">DebugString</span><span class="token punctuation" style="color:#393A34">(</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token template-string string" style="color:#e3116c">Value: </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">${</span><span class="token template-string interpolation">value</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">}</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></div></code></pre></div><br><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="npm-dependencies"></a>NPM Dependencies<a aria-hidden="true" tabindex="-1" class="hash-link" href="#npm-dependencies" title="Direct link to heading">#</a></h3><p>Currently, TypeScriptToLua does not support installing dependencies from NPM; see <a href="https://github.com/TypeScriptToLua/TypeScriptToLua/issues/432" target="_blank" rel="noopener noreferrer">this issue</a>. This means that for now, it will be cumbersome to write Isaac-specific libraries for people to use.</p><p>Hopefully, this feature will be ready soon.</p><br><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="throwing-errors"></a>Throwing Errors<a aria-hidden="true" tabindex="-1" class="hash-link" href="#throwing-errors" title="Direct link to heading">#</a></h3><p>Normally, in TypeScript programs, you would handle errors with <code>throw new Error(&quot;foo&quot;)</code>. For example:</p><div class="mdxCodeBlock_1XEh"><pre class="prism-code language-typescript codeBlock_222H"><button type="button" aria-label="Copy code to clipboard" class="copyButton_ujp3">Copy</button><a aria-label="Open code on playground" class="playgroundButton_3DKR" target="_blank" href="/play/#code/MYewdgzgLgBADgGwIYE8CmAnGBeGBJCJJYAOgHE0oAFZdDACgEoYB6FmAFQAs0YoU4vEADN4tTDACWEGACIAomCiT+NVBIA+MMAFcECWQChJo+onVZsV7XoTMA3oZh8uGEAHdtaT-IxuGsgBiSJIIaAAmfCAwAOaULrzmdACEsoyGAL6GSZgkAILh4QDKIHoAEmhIGFAQ9ACMzGycPHwCQqI5WNLaHnKKyqriGLJAA">Playground</a><code class="codeBlockLines_3zpG" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> player </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token maybe-class-name">Isaac</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access maybe-class-name" style="color:#d73a49">GetPlayer</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// The type of player is &quot;EntityPlayer | null&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">player </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">throw</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Error</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Failed to get the player!&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">player</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access maybe-class-name" style="color:#d73a49">AddSoulHearts</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// The type of player is now &quot;EntityPlayer&quot;</span></div></code></pre></div><p>However, in Isaac mods, this code won&#x27;t work. It will error with something along the lines of the following:</p><p><code>[Foo] Error in &quot;foo&quot; call: ...n\The Binding of Isaac Rebirth/mods/foo/main.lua:100: attempt to index a nil value (global &#x27;debug&#x27;)</code></p><p>This is because TypeScriptToLua transpiles <code>throw</code> to a function that uses Lua&#x27;s <code>debug</code> library, and Isaac does not have access to <code>debug</code> for sandboxing reasons. But not to worry, because instead we can simply use Lua&#x27;s <code>error()</code> function. For example:</p><div class="mdxCodeBlock_1XEh"><pre class="prism-code language-typescript codeBlock_222H"><button type="button" aria-label="Copy code to clipboard" class="copyButton_ujp3">Copy</button><a aria-label="Open code on playground" class="playgroundButton_3DKR" target="_blank" href="/play/#code/MYewdgzgLgBADgGwIYE8CmAnGBeGBJCJJYAOgHE0oAFZdDACgEoYB6FmAFQAs0YoU4vEADN4tTDACWEGACIAomCiT+NVBIA+MMAFcECWQChJo+onVZsV7XoTMA3oZgxMGEA1kAxJJIRoAJnwgMADmlHw8YhYAhLKMhgC+huZ0JACC-v4AyiB6ABJoSBhQEPQAjMxsnJH8gjAiUXRSMmAgAO5yisqq4hiyQA">Playground</a><code class="codeBlockLines_3zpG" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> player </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token maybe-class-name">Isaac</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access maybe-class-name" style="color:#d73a49">GetPlayer</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// The type of player is &quot;EntityPlayer | null&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">player </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">error</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Failed to get the player!&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">player</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access maybe-class-name" style="color:#d73a49">AddSoulHearts</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// The type of player is now &quot;EntityPlayer&quot;</span></div></code></pre></div><p>(TypeScript is smart enough to know that <code>error()</code> can constrain the type of player in the same way that <code>throw</code> normally would.)</p><br><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="no-blank-mod-classes"></a>No Blank Mod Classes<a aria-hidden="true" tabindex="-1" class="hash-link" href="#no-blank-mod-classes" title="Direct link to heading">#</a></h3><p>You cannot instantiate a blank mod object/class:</p><div class="mdxCodeBlock_1XEh"><pre class="prism-code language-typescript codeBlock_222H"><button type="button" aria-label="Copy code to clipboard" class="copyButton_ujp3">Copy</button><a aria-label="Open code on playground" class="playgroundButton_3DKR" target="_blank" href="/play/#code/PTAEBUE8AcFMGUDGAnAltALqRB7AJrAFC4B2AzlgEqwBusANgIYao7mgC8o1A5qhbGQBZfAAoARNTpMWbMuIA0oAIwBKANygQoSbQbNW5caAAWjMqAwnYlmDfEi84wsSZkLAMRw5QAb0KgWmAA6jYAtqg8JlgkOFgA7owkWBg+BABmqCQ2jLZwoDjpOo6gAD6gJACu9PSKAUGgZD7xZlioRfE2lWQ5oABGTCQA1thuZAD89WH4APJ9AFawiFhcjqIahAC+xHJY6d6cFbDxoF446+ou2gAyzIIFJKBZltbY+LBKndhJBXTI8WgMDZUBhCPscAA6aZ4OaLZaHKT6WTkdRAA">Playground</a><code class="codeBlockLines_3zpG" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// TypeScript code</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token maybe-class-name">Revelations</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:#d73a49">RegisterMod</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Revelations&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// &quot;Revelations&quot; has the type &quot;Mod&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">Foo</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// We might not want to define a type of &quot;Mod | null&quot;,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// so what if we use a blank class?</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  modObject </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:#d73a49">Mod</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> foo </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Foo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Later on in the code, we can overwrite it</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">foo</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">modObject</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token maybe-class-name">Revelations</span><span class="token punctuation" style="color:#393A34">;</span></div></code></pre></div><p>Doing this will result in an error in the following TypeScriptToLua boilerplate code:</p><div class="mdxCodeBlock_1XEh"><pre class="prism-code language-lua codeBlock_222H"><button type="button" aria-label="Copy code to clipboard" class="copyButton_ujp3">Copy</button><code class="codeBlockLines_3zpG" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">function __TS__New(target, ...)</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    local instance = setmetatable({}, target.prototype) -- Error on this line</span></div></code></pre></div><p>To fix this problem, do something like the following:</p><div class="mdxCodeBlock_1XEh"><pre class="prism-code language-typescript codeBlock_222H"><button type="button" aria-label="Copy code to clipboard" class="copyButton_ujp3">Copy</button><a aria-label="Open code on playground" class="playgroundButton_3DKR" target="_blank" href="/play/#code/PTAEBUE8AcFMGUDGAnAltALqRB7AJrAFC4B2AzlgEqwBusANgIYao7mgC8o1A5qhbGQBZfAAoARNTpMWbMuIA0oAIwBKANygQoSbQbNW5caAAWjMqAwnYlmDfEi84wsSZkLAMRw5QAb0KgoAC2+ADyAEYAVrCIGABcoI6gAD6gJACu9PScaZn06oQAvsRyWABm3jkksADuoF44ohou2gAyzIKgbKCoJJbW2PiwSjU2iIx9OHTINWgYNqgYhBU4AHQheBHRsTlS+rLk6kA">Playground</a><code class="codeBlockLines_3zpG" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// TypeScript code</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token maybe-class-name">Revelations</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:#d73a49">RegisterMod</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Revelations&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// &quot;Revelations&quot; has the type &quot;Mod&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">Foo</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  modObject</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">Mod</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">null</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> foo </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Foo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Later on in the code, we can overwrite it</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">foo</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">modObject</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token maybe-class-name">Revelations</span><span class="token punctuation" style="color:#393A34">;</span></div></code></pre></div></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/IsaacScript/isaacscript.github.io/edit/main/docs/gotchas.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/publishing-to-the-workshop"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Publishing to the Workshop</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/function-signatures"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Function Signatures Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_3SO_"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#extending-enums----custom-enums" class="table-of-contents__link">Extending Enums --&gt; Custom Enums</a></li><li><a href="#int-and-float" class="table-of-contents__link"><code>int</code> and <code>float</code></a></li><li><a href="#vector-operators" class="table-of-contents__link">Vector Operators</a></li><li><a href="#using-tearflags--bitset128" class="table-of-contents__link">Using TearFlags / BitSet128</a></li><li><a href="#using-json" class="table-of-contents__link">Using JSON</a></li><li><a href="#iterating-over-enums" class="table-of-contents__link">Iterating Over Enums</a></li><li><a href="#npm-dependencies" class="table-of-contents__link">NPM Dependencies</a></li><li><a href="#throwing-errors" class="table-of-contents__link">Throwing Errors</a></li><li><a href="#no-blank-mod-classes" class="table-of-contents__link">No Blank Mod Classes</a></li></ul></div></div></div></div></main></div></div></div>
<script src="/styles.a1659319.js"></script>
<script src="/runtime~main.e322ed83.js"></script>
<script src="/main.2a6f29c3.js"></script>
<script src="/1.1509b875.js"></script>
<script src="/2.da43fd8b.js"></script>
<script src="/4.db0f1a5a.js"></script>
<script src="/1be78505.d3e7d32c.js"></script>
<script src="/28.252c0842.js"></script>
<script src="/935f2afb.24783415.js"></script>
<script src="/17896441.8ab7f4e3.js"></script>
<script src="/b2dbe049.90994bf3.js"></script>
</body>
</html>